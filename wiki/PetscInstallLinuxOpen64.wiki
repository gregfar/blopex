#summary PETSc install with AMD's OPEN64 compiler in Fedora 13

= Introduction =

How To install PETSc with AMD's OPEN64 compiler in Fedora13 64 bit
(assuming bash shell)

= Details =

The basic system info:

{{{
>> uname -a
Linux opt4 2.6.33.5-124.fc13.x86_64 #1 SMP Fri Jun 11 09:38:12 UTC 2010 x86_64 x86_64 x86_64 GNU/Linux
}}}

Download from http://developer.amd.com/cpu/open64/ and install the AMD's OPEN64 compiler. 
The default location is /opt/x86_open64-4.2.3.2/ (depending on the version number). Make sure that you add the OPEN64 binaries location to your PATH: 

{{{
>> PATH=/opt/x86_open64-4.2.3.2/bin/:$PATH; export PATH
>>  which opencc
/opt/x86_open64-4.2.3.2/bin/opencc
}}}

Download and install ACML libraries, compiled with OPEN64: 
 * http://developer.amd.com/Downloads/acml-4-4-0-open64-64bit.tgz
 * http://developer.amd.com/Downloads/acml-4-4-0-open64-64bit-int64.tgz
The default locations are: 
   * /opt/acml-4-4-0-open64-64bit
   * /opt/acml-4-4-0-open64-64bit-int64

Each library comes in two different flavours, regular and mp, e.g., 
   * /opt/acml4.4.0/open64_64/lib
   * /opt/acml4.4.0/open64_64_mp/lib

According to Ch. 2 of the ACML manual, see  
http://developer.amd.com/assets/acml_userguide.pdf
one should use the mp version on a multi-CPU/core nodes.

You need set the path to the libraries by running

{{{
>> LD_LIBRARY_PATH=/opt/acml4.4.0/open64_64_mp/lib; export LD_LIBRARY_PATH
}}}

If SELinux is active, disable SELinux temporarily by running (as root) 

{{{
>> echo 0 > /selinux/enforce 
}}}

After you are done running the codes, restore SELinux by 

{{{
>> echo 1 > /selinux/enforce
}}}

Download and extract the latest PETSc, at the moment this is 
ftp://info.mcs.anl.gov/pub/petsc/release-snapshots/petsc-lite-3.1.tar.gz

Extract using *tar xzvf* , rename the PETSc dir as you like, cd to PETSc dir and run 

{{{
>> PETSC_DIR=$PWD; export PETSC_DIR
}}}

Version petsc-3.1-p3 and later already includes the latest BLOPEX code! 
Run configure, e.g., 

{{{
>> ./configure --with-blas-lapack-dir=/opt/acml4.4.0/open64_64_mp --with-cc=opencc --with-cxx=openCC --with-fc=openf95 --download-blopex=1 --download-hypre=1 --download-openmpi=1
}}}

