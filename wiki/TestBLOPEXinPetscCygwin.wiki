#summary BLOPEX _Double_ PETSc testing on Cygwin
<wiki:toc max_depth="2" />

= Introduction =

Testing BLOPEX in PETSc Version 3.0. 0-p5 and system configuration:
  * Intel(R) Pentium(R) ,4 CPU ,3.06GHz,3.24 GB of RAM
  * Operation system: Windows XP  using Cygwin 
  * MPI:mpich2-1.0.8
  * fblaslapack3.1.1
  * C compiler:gcc3.4.4
  
= Setup PETSc =  

To test BLOPEX in PETSc, we need to download PETSc Release Version 3.0.0-p5 from  http://www.mcs.anl.gov/petsc/petsc-2/download/index.html. To install PETSc, one can see the installation section http://www.mcs.anl.gov/petsc/petsc-2/documentation/installation.html.  In particular, if you install in windows, see 
http://www.caspur.it/risorse/softappl/doc/petsc_docs/installation/win.htm. One can download Cygwin from http://cygwin.com/.

I download Petsc3.0.0-p5 in E:/petsc_test/. Extract PETSc files from download file.
{{{
$cd  /cygdrive/e/petsc_test
$ gunzip -c  petsc-3.0.0-p5.tar.gz |  tar -xof-
}}}
This creates files in directory petsc_test. Next, change directory to petsc-3.0.0-p5.
{{{
$ cd petsc-3.0.0-p5
}}}

Set environment variable: PETSC_DIR (location of the PETSc installation)
 {{{
$ PETSC_DIR=$PWD
$ export PETSC_DIR
}}}

Now configure PETSc: 
{{{
$ ./config/configure.py --with-cc=gcc --with-fc=g77 --download-f-blas-lapack=1 --download-mpich=1 --download-hypre=1 --download-blopex=1
}}}
The command line parameters will download & install BLAS, LAPACK, MPICH ,HYPRE and BLOPEX if they are not already installed on the system.

After configuration is finished,set another environment variable :PETSC_ARCH
{{{
$PETSC_ARCH=cygwin-c-debug; export PETSC_ARCH
}}}

{{{
$ make all test  
or
$make all
$make test
}}}


= Execution of Tests  =
==Test for driver==
To execute tests shift from ${PETSC_DIR} to ${PETSC_DIR}\src\contrib\blopex\driver
and run the makefile:
{{{
$make driver
}}}

Find 5 first eigenpairs, 100 iterations,  random initial guess: 
{{{	
$./driver -n_eigs 5 -tol 1e-6 -itr 100 >out1.doc
}}}
Save the output result in file out1.doc.

{{{
Eigenvalue lambda 2.4304215831301604e-01
Eigenvalue lambda 4.7952103987970973e-01
Eigenvalue lambda 4.7952103987973310e-01
Eigenvalue lambda 4.7952103988014627e-01
Eigenvalue lambda 7.1599992144661806e-01
Residual 1.4382428158142916e-07
Residual 4.6396910879626088e-07
Residual 9.0450423144749722e-07
Residual 8.8814277603170674e-07
Residual 4.4391485473228517e-07

17 iterations
Solution process, seconds: 3.446193e-01
}}}

==Tests for  driver_fiedler==

driver_fiedler accepts as input matrices in Petsc format. 
For our tests we use  L-matrix-double.petsc (65536x65536 diagonal values 0-4) and DL-matrix-double.petsc (65536x65536 tridiagonal values 0-4). One can obtain them by checking out the current BLOPEX source code from http://code.google.com/p/blopex/ - in the blopex_petsc/driver_fiedler directory.

We first run driver_fiedler for the matrix provided in _L -matrix-double.petsc_.
	
Find 5  first eigenpairs, 100 iterations,random initial guess: 
{{{
$./driver_fiedler -matrix L-matrix-double.petsc -n_eigs 5 -tol 1e-6 -itr 100 >out_L_double.doc
}}}
Save the output result in file out_L_double.doc.

{{{
Eigenvalue lambda 3.2405807000580995e-06
Eigenvalue lambda 9.4602270300948199e-06
Eigenvalue lambda 2.0138056930651788e-05
Eigenvalue lambda 2.3958362821323563e-05
Eigenvalue lambda 2.7851586430932628e-05
Residual 4.0641950980955997e-07
Residual 1.9882705226116018e-07
Residual 2.9428844113409334e-07
Residual 8.6976666567477748e-07
Residual 7.8671374942382747e-07

12 iterations
Solution process, seconds: 5.098956e+02
}}}

Now we run similar tests for the matrix provided in _DL-matrix-double.petsc_.
First 5 eigenpairs, the initial guess is random, 100 iterations:
{{{
$./driver_fiedler -matrix DL-matrix-double.petsc -n_eigs 5 -tol 1e-6 -itr 100 >out_DL_double.doc
}}}
Save the output result in file out_DL_double.doc.

{{{
Eigenvalue lambda 4.0146357966154770e-05
Eigenvalue lambda 4.0189399982762966e-05
Eigenvalue lambda 4.0221758423109092e-05
Eigenvalue lambda 4.0282813832156639e-05
Eigenvalue lambda 4.0381103489691756e-05
Residual 3.9655724478919523e-06
Residual 3.4716484239816607e-06
Residual 3.8272905782502263e-06
Residual 1.1397676547837112e-05
Residual 1.2677073936342406e-05

100 iterations
Solution process, seconds: 3.776326e+01
}}}
